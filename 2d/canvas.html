<html>
 <head>
  <script type="application/javascript">
  
    var p = new Array();
    var p2 = new Array();
    var ctx = null;
  
    function draw() {
      var canvas = document.getElementById("canvas");
      if (canvas.getContext) {
        ctx  = canvas.getContext("2d");


        canvas.addEventListener("mousemove", onMove, false);
        canvas.addEventListener("click", halmaonclick, false);
        canvas.addEventListener("dblclick", onDblclick, false);
        
      }
    }
    function onDblclick(e) {
        p2.push(p2[0]);
        drawPoly();
        
        canvas.removeEventListener("mousemove", onMove, false);
        canvas.removeEventListener("click", halmaonclick, false); 
        
        getBoundingBox();       
    }
    function halmaonclick(e) {
        a = {
            x:e.pageX,
            y:e.pageY
        };
        p2.push(a);
        
        drawPoly();

    }
    function onMove(e) {
        a = {
            x:e.pageX,
            y:e.pageY
        };
        p2.pop();
        p2.push(a);
        

        
        if (p2.length == 0) {
         
        }    
        else {
            drawPoly();
        }       
    }
    function drawPoly() {
        ctx.clearRect ( 0 , 0 , 1920 , 1080 );
        ctx.fillStyle = "rgba(0,150,0,0.2)";        
        
        ctx.lineCap = "round";
        ctx.lineJoin = "bevel";                
        ctx.beginPath();          
        
        for (var i = 0; i<p2.length; i++) {
            if (i==0) {
               ctx.moveTo(p2[i].x,p2[i].y); 
            }
            else {
                ctx.lineTo(p2[i].x,p2[i].y);
            }
        }
        
        
        ctx.stroke();  

        ctx.fill();  
        
        //document.getElementById("blaa").innerHTML = ctx.isPointInPath(100, 100);      
    }
    
    function getBoundingBox() {
        var x1 = 100000;
        var x2 = -1;
        var y1 = 100000;
        var y2 = -1
        
        for (var i = 0; i<p2.length; i++) {
            if (p2[i].x < x1) {
                x1 = p2[i].x;
            }
            if (p2[i].x > x2) {
                x2 = p2[i].x;
            }
            if (p2[i].y < y1) {
                y1 = p2[i].y;
            }
            if (p2[i].y > y2) {
                y2 = p2[i].y;
            }                                   
        }
        
        var width = x2-x1;
        var height = y2-y1;
        
        var maxwidth = 50;
        var maxheight = 50;
        
        var widthscal = maxwidth / width;
        var heightscal = maxheight / height;
                
        for (var i = 0; i<p2.length; i++) {
            p2[i].x = Math.round((p2[i].x -x1) * widthscal);       
            p2[i].y = Math.round((p2[i].y-y1) * heightscal);                             
        }
        
        drawPoly();
    }
  </script>
  <link rel="stylesheet" href="css/test.css">  
 </head>
 <body onload="draw();">
     <div id="blaa"></div>
   <canvas id="canvas" width="1920" height="1080"></canvas>
   
 </body>
</html>